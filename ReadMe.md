## Известные проблемы при работе с удалённым хранилищем

### Проблемы чтения кодировки windows-1251 из удалённого хранилища

1. При просмотре в [удалённом хранилище] по умолчанию файлы отображаются в кодировке `UTF-8`.
2. При редактировании в [удалённом хранилище] файлы пересохраняются в кодировке `UTF-8`.
3. Отредактированные файлы в папке `/src/*.*` после [скачивания в ZIP] 
необходимо открыть в **Текстовом редакторе** и пересохранить как `ANSI`. 
При импорте модули должны быть в кодировке `windows-1251`.
4. Чтобы после импортирования модулей каждый раз при сохранении (и автосохранении) 
не отображалось сообщение "Будьте внимательны! В документе могут быть персональные данные, 
которые невозможно удалить с помощью инспектора документов." нужно зайти 
в "Параметры" **Excel** -> "Центр управления безопасностью", в меню 
"Параметры конфиденциальности" отключить параметр 
"Удалять персональные данные из свойств файла при сохранении".  
Тоже самое слелает макрос:
	``` vba
	Sub ConfidentialInformationAlert_Disable()
	  If ActiveWorkbook.RemovePersonalInformation Then ActiveWorkbook.RemovePersonalInformation = False
	End Sub
	```

[удалённом хранилище]: ../master/src
[скачивания в ZIP]: ../../archive/master.zip

### Настройка кодировки файлов в Windows через фильтр Git

1. Чтобы Git сохранял изменения файлов без BOM автоматически 
нужно скачать [клиентский хук] в директорию `<REPO>\.git\hooks` без расширения `.sh`  
Хук будет выполняться перед сохранением изменений (commit).
2. Для Windows необходимо задать автоматическую замену переноса строк
	``` bash
	# Не изменять окончания строк в удалённом хранилище
	$ git config core.autocrlf true
	$ git config core.eol crlf
	```
3. Установить флаг `--no-ff`, чтобы Git всегда создавал отдельный объект с изменениями 
перед слиянием. Информация о существующей ветви не потеряется.
	``` bash
	$ git config --global merge.ff false
	```

4. Используйте текстовый редактор, который при сохранении файлов оставляет только 
единственный символ переноса строк `CRLF`. Теперь можно работать с файлами 
через Git Bash или Git Desktop Client не заботясь о кодировке.

[клиентский хук]: //gist.github.com/c55f1538454755fdff71fba0d686e371

# 
