## Известные проблемы при работе с удалённым хранилищем

<a name="setup-repo-after-copy-files"></a>
### Настройка репозитория после копирования файлов

1. При просмотре в [удалённом хранилище] по умолчанию файлы отображаются в кодировке `UTF-8`.

2. При редактировании в [удалённом хранилище] файлы пересохраняются в кодировке `UTF-8`.

3. Отредактированные файлы в папке `<REPO>/src/*.*` после [скачивания в ZIP] 
   необходимо открыть в **Текстовом редакторе** в кодировке `windows-1251`.

4. Чтобы после импортирования модулей каждый раз при сохранении (и автосохранении) 
   не отображалось сообщение "*Будьте внимательны! В документе могут быть персональные 
   данные, которые невозможно удалить с помощью инспектора документов.*" 
   нужно зайти в "Параметры" **Excel** -> "Центр управления безопасностью", 
   в меню "Параметры конфиденциальности" отключить параметр 
   "Удалять персональные данные из свойств файла при сохранении".  
   Тоже самое сделает макрос:
   ``` vba
   Sub ConfidentialInformationAlert_Disable()
     If ActiveWorkbook.RemovePersonalInformation Then ActiveWorkbook.RemovePersonalInformation = False
   End Sub
   ```

[удалённом хранилище]: ../master/src
[скачивания в ZIP]: ../../archive/master.zip

<a name="set-codepage-1251"></a>
### Настройка кодировки файлов windows-1251 для модулей через фильтр Git

1. Чтобы Git старых версий сохранял изменения файлов без BOM автоматически 
   нужно скачать [клиентский хук] в директорию `<REPO>/.git/hooks` без расширения `.sh`  
   Хук будет выполняться перед сохранением изменений (*commit*).

2. Установить флаг `--no-ff`, чтобы Git всегда создавал отдельный объект с изменениями 
   перед слиянием. Информация о существующей ветви не потеряется.
   ``` console
   $ git config --local merge.ff false
   ```

3. Используйте текстовый редактор, который при сохранении файлов оставляет только 
   единственный символ переноса строк `CRLF`. Репозиторий имеет настройки для работы в 
   Git Bash или Git Desktop Client. Для работы в текстовом редакторе **vscode** 
   необходимо добавить следующие настройки:
   ``` json
   "[vb][vba]": {
   	"editor.defaultFormatter": "serkonda7.vscode-vba",
   	"editor.insertSpaces": true,
   	"editor.fontFamily": "Menlo, Monaco, 'Courier New', monospaces",
   	"editor.fontSize": 13,
   	"editor.language.brackets": [ [ "(", ")" ] ],
   	"editor.lineHeight": 16,
   	"editor.maxTokenizationLineLength": 2000,
   	"editor.rulers": [ 80, { "column": 120, "color": "#ff0000" } ],
   	"editor.tabSize": 2,
   	"files.autoGuessEncoding": true,
   	"files.encoding": "windows1251",
   	"files.insertFinalNewline": true
   },
   ```

[клиентский хук]: //gist.github.com/c55f1538454755fdff71fba0d686e371

# 
